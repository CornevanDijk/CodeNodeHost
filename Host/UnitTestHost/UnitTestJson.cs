using System;
using System.Text;
using System.Collections.Generic;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Host;
using System.IO.Ports;
using Moq;

namespace UnitTestHost
{
    /// <summary>
    /// Summary description for UnitTest1
    /// </summary>
    [TestClass]
    public class UnitTestJson
    {
        public UnitTestJson()
        {
            //
            // TODO: Add constructor logic here
            //
        }

        [TestMethod]
        public void TestReadJson()
        {
            var sensNr = 1;
            var instNr = 20;
            var bRet = 30;
            var data0 = 123456;
            var data1 = 654321;


            Json json = new Json();
            //Serial serial = new Serial();
            Mock<ISerialPort> port = new Mock<ISerialPort>();
            //serial.GetPort().Open();
            port.Setup(p => p.ReadLine()).Returns("{\"sensNr\":" + sensNr + ",\"instNr\":" + instNr + ",\"bRet\":" + bRet + ",\"data\":[" + data0 + ", " + data1 + "]}");

            var result = json.ReadJson(port.Object);
            Assert.AreEqual(result.SensNr, sensNr);
            Assert.AreEqual(result.InstNr, instNr);
            Assert.AreEqual(result.BRet, bRet);
            Assert.AreEqual(result.Data[0], data0);
            Assert.AreEqual(result.Data[1], data1);
        }

        [TestMethod]
        [ExpectedException(typeof(ArgumentNullException))]
           public void TestArgumentNullex()
        {
            Json json = new Json();
            json.MakeJson("",null);
        }

        //[TestMethod]
        //public void TestMakeJson()
        //{
        //    Json json = new Json();
        //    int[] array = { 11, 20 };
        //    DataJson dataJson = new DataJson(1, 20, 30, array);
        //    string path = @"D:\HBO\Semester 4\PTT";
        //    json.MakeJson(path, dataJson);
        //}
    }
}
